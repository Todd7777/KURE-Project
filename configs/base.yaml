# Base configuration for Nonlinear Rectified Flows

# Model architecture
model:
  latent_channels: 4
  latent_size: 64
  model_channels: 256
  channel_mult: [1, 2, 3, 4]
  num_res_blocks: 2
  context_dim: 768  # CLIP text embedding dimension
  time_embed_dim: 1024
  time_schedule: "linear"  # linear, cosine, sigmoid, exponential

# Teacher configuration (overridden in specific configs)
teacher:
  type: "linear"

# Data configuration
data:
  dataset: "cc3m"  # cc3m, laion, coco
  image_size: 256
  in_channels: 3
  num_workers: 8
  use_validation: true

# Training configuration
training:
  num_epochs: 100
  batch_size: 64
  learning_rate: 1.0e-4
  weight_decay: 1.0e-4
  betas: [0.9, 0.999]
  min_lr: 1.0e-6
  grad_clip: 1.0
  ema_decay: 0.9999
  
  # Loss configuration
  loss_type: "mse"  # mse, huber, lpips
  reg_weight: 0.01
  
  # Mixed precision
  use_amp: true
  
  # Logging and checkpointing
  log_interval: 100
  val_interval: 1000
  save_interval: 5000
  checkpoint_dir: "checkpoints"
  
  # Weights & Biases
  use_wandb: true
  wandb_project: "nonlinear-rectified-flows"
  run_name: null

# VAE configuration
vae_checkpoint: null  # Path to pretrained VAE

# Evaluation configuration
evaluation:
  num_samples: 5000
  batch_size: 32
  step_budgets: [1, 2, 4, 8]
  solver: "euler"  # euler, heun, rk4
